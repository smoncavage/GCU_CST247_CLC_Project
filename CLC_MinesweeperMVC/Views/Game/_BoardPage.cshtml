@using CLC_MinesweeperMVC.Controllers
@using CLC_MinesweeperMVC.Models
@model CLC_MinesweeperMVC.Models.BoardModel
@{
    ViewBag.Title="BoardPage";
    Layout="~/Views/Shared/_Layout.cshtml";
    var ajaxOptions = new AjaxOptions();

    ajaxOptions.HttpMethod="POST";
    ajaxOptions.InsertionMode=InsertionMode.Replace;
    ajaxOptions.UpdateTargetId="boardDetails";

}
@section scripts {
    <script>
        function myFunction() {
            $.ajax({
                type: "POST",
                url: "OnButtonClick/BoardButtons.ID",
                async: false,
                success: function (msg) {
                    ServiceSucceeded(msg);
                },
                error: function () {
                    return "error";
                }
            })
            
        }
    </script>
}

<div id="boardDetails" style="text-align:center">
    @using(Html.BeginForm("OnButtonClick", "Game", FormMethod.Post, new { id = "myForm" })) {
        <table align="center" id="Table" cellspacing="0">
            @{
                var difficulty = ViewBag.Message*7;
                var brdSize = difficulty;
                int count = -1;
                //List<CellModel> cllMdl = ViewBag.ButtonList;
            }

            @for(int rw = 0; rw<Model.Size; rw++) {
                <tr>
                    @for(int cl = 0; cl<Model.Size; cl++) {
                        count++;
                        var buttonId = count;
                        <td>

                            <button name="BoardButtons" style="width:32px; height:32px;background-color:beige" id="@buttonId+" type="submit" value="@count" onclick="myFunction">

                                @if(Model.grid[rw, cl].visited&&Model.grid[rw, cl].live) {

                                    <img src="~/Images/bomb.bmp" />

                                }
                                else if(Model.grid[rw, cl].visited&&!Model.grid[rw, cl].live) {
                                    <value style="font-family:Stencil; background-color:chartreuse">@Model.grid[rw, cl].liveNeighbors</value>
                                }

                                <!--<img src="~/Images/checkered_flag.bmp" />-->
                            </button>
                        </td>
                    }
                </tr>
            }

        </table>
    }
</div>